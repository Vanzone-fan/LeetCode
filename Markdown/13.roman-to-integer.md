# roman-to-integer 2024-07-13


**最原始的代码**

```javascript
/*
 * @lc app=leetcode id=13 lang=javascript
 *
 * [13] Roman to Integer
 */

// @lc code=start
/**
 * @param {string} s
 * @return {number}
 */
var romanToInt = function(s) {
    var array = [
        {'roman':'I', 'integer':1},
        {'roman':'IV', 'integer':4},
        {'roman':'V', 'integer':5},
        {'roman':'IX', 'integer':9},
        {'roman':'X', 'integer':10},
        {'roman':'XL', 'integer':40},
        {'roman':'L', 'integer':50},
        {'roman':'XC', 'integer':90},
        {'roman':'C', 'integer':100},
        {'roman':'CD', 'integer':400},
        {'roman':'D', 'integer':500},
        {'roman':'CM', 'integer':900},
        {'roman':'M', 'integer':1000}
    ];
    var result = 0;
    outer: for(var i = 0;i<s.length;i++){
        inner: array.forEach(convert => {
            if(convert['roman'] == s[i]+s[++i]){
                result += convert['integer'];
                i++;
                // 外层下一次循环
                continue outer;
            }
            if(convert['roman'] == s[i]){
                result += convert['integer'];
                //外层下一次循环
                continue outer;
            }
        })
    }
};
// @lc code=end
romanToInt('III')
```

**出现的问题**

- 官方报错
```javascript
 Line 35 in solution.js
                continue outer;
                         ^^^^^
SyntaxError: Undefined label 'outer'
```
- 在if判断中局部++i可以理解，但是如果这个if判断失败i也已经发生改变，索引的连续变化可能导致最后问题的出现
- forEach函数中continue只会作用于自身，不能跳出外层循环，也就是VS Code官方报错：跳转目标不能跨越函数边界。跳转目标应该作用于多重循环，而调用函数就不能再实现目标跳转
- 没有return

**改进代码**

```javascript
symbols = {
    "I": 1,
    "V": 5,
    "X": 10,
    "L": 50,
    "C": 100,
    "D": 500,
    "M": 1000
};

var romanToInt = function(s) {
    value = 0;
    for(let i = 0; i < s.length; i+=1){
        symbols[s[i]] < symbols[s[i+1]] ? value -= symbols[s[i]]: value += symbols[s[i]]
    }
    return value
};
```

**代码评估**
发现了罗马数字编码递减规律，所以代码整体简洁许多，如果出现特例，通用规律必是局部递增，所以只需要做减法，正常情况做加法。